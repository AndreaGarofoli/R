library(estimate)
library("illuminaHumanv4.db")

discovs=read.table("/Users/andrea/Documents/BI/BI/B/PhD/PythonProject/PythonProject/out/VdatasetTraining.csv", sep=",", header= TRUE, row.names=1)
 # exprs_discov

probeID=c(rownames(discovs))

probeID=c("ILMN_1755710", "ILMN_1741133", "ILMN_2374778", "ILMN_1764964", "ILMN_1803392", "ILMN_1665696", "ILMN_1681703", "ILMN_2372543", "ILMN_1699603", "ILMN_1693594", "ILMN_2359698", "ILMN_1808591", "ILMN_1702829", "ILMN_1732926", "ILMN_1677920", "ILMN_1729115", "ILMN_1727840", "ILMN_1728550", "ILMN_1785731", "ILMN_1677314", "ILMN_2104141", "ILMN_1774602", "ILMN_2175317", "ILMN_1779064", "ILMN_1706505", "ILMN_1800317", "ILMN_2371911", "ILMN_2307861", "ILMN_1732688", "ILMN_1766245", "ILMN_1743911", "ILMN_1722849", "ILMN_1715748", "ILMN_1706643", "ILMN_1720511", "ILMN_1783909", "ILMN_2193980", "ILMN_1662964", "ILMN_1685112", "ILMN_1675239", "ILMN_2163796", "ILMN_1693430", "ILMN_1687359", "ILMN_2381064", "ILMN_1672536", "ILMN_1732151", "ILMN_2323848", "ILMN_2180371", "ILMN_1660869", "ILMN_1655261", "ILMN_1662905", "ILMN_1769926", "ILMN_1654151", "ILMN_1704557", "ILMN_1795166", "ILMN_1767665", "ILMN_1693367", "ILMN_2332250", "ILMN_2223903", "ILMN_2102330", "ILMN_1678842", "ILMN_1679262", "ILMN_1657509", "ILMN_1803213", "ILMN_1732066", "ILMN_1799289", "ILMN_1664303", "ILMN_1691290", "ILMN_1704084", "ILMN_2098325", "ILMN_1753345", "ILMN_1782551", "ILMN_1662147", "ILMN_2149766", "ILMN_2390919", "ILMN_1704477", "ILMN_1741356", "ILMN_1785272", "ILMN_1793672", "ILMN_1739496", "ILMN_1676563", "ILMN_2083469", "ILMN_1701308", "ILMN_1657864", "ILMN_1803846", "ILMN_1776936", "ILMN_1792363", "ILMN_2111237", "ILMN_1656196", "ILMN_1790354", "ILMN_1698533", "ILMN_2115633", "ILMN_1813389", "ILMN_1713499", "ILMN_1765557", "ILMN_1754660", "ILMN_2055330", "ILMN_1715476", "ILMN_2201678", "ILMN_1757497", "ILMN_2330787", "ILMN_1680652", "ILMN_1783182", "ILMN_1774860", "ILMN_1733756", "ILMN_1667361", "ILMN_1763491", "ILMN_2061732", "ILMN_1729117", "ILMN_1705442", "ILMN_1673795", "ILMN_2331266", "ILMN_2401618", "ILMN_1734276", "ILMN_1745271", "ILMN_1804448", "ILMN_2309156", "ILMN_1763884", "ILMN_1771179", "ILMN_1791226", "ILMN_1717420", "ILMN_1656373", "ILMN_1664294", "ILMN_1769282", "ILMN_2331082", "ILMN_1669032", "ILMN_1661443", "ILMN_1685433", "ILMN_1812526", "ILMN_2234873", "ILMN_2366490", "ILMN_1731206", "ILMN_1721391", "ILMN_1732197", "ILMN_1679809", "ILMN_2331087", "ILMN_1707070", "ILMN_1779875", "ILMN_1669772", "ILMN_1815345", "ILMN_1805131", "ILMN_1712298", "ILMN_1679867", "ILMN_1654112", "ILMN_1740265", "ILMN_1731178", "ILMN_1809928", "ILMN_1719664", "ILMN_1654851", "ILMN_1674050", "ILMN_1709479", "ILMN_1736178", "ILMN_1917341", "ILMN_1790659", "ILMN_1790689", "ILMN_1844692", "ILMN_1788099", "ILMN_1698732", "ILMN_1681984", "ILMN_1784655", "ILMN_2402392", "ILMN_1694810", "ILMN_1743130", "ILMN_2185984", "ILMN_1670817", "ILMN_1683052", "ILMN_1762106", "ILMN_1665621", "ILMN_1748578", "ILMN_1767362", "ILMN_1782439", "ILMN_1729144", "ILMN_1733390", "ILMN_1694012", "ILMN_1761762", "ILMN_1662438", "ILMN_2370208", "ILMN_1796755", "ILMN_1756715", "ILMN_1713835", "ILMN_2311166", "ILMN_1715647", "ILMN_1679632", "ILMN_1728645", "ILMN_1769433", "ILMN_1688637", "ILMN_1750511", "ILMN_1796734", "ILMN_1760412", "ILMN_1712673", "ILMN_1652540", "ILMN_1709674", "ILMN_1788783", "ILMN_1749636", "ILMN_1701681", "ILMN_1709605", "ILMN_1810856", "ILMN_1739987", "ILMN_1670379", "ILMN_2262930", "ILMN_1682781", "ILMN_1748883", "ILMN_1789502", "ILMN_2396002", "ILMN_1752932", "ILMN_1796397", "ILMN_1789112", "ILMN_1779882", "ILMN_1840674", "ILMN_1689274", "ILMN_1704369", "ILMN_1680738", "ILMN_1742534", "ILMN_1777765", "ILMN_2310685", "ILMN_1665257", "ILMN_1795429", "ILMN_1721167", "ILMN_1779147", "ILMN_1671895", "ILMN_1741954", "ILMN_1760246", "ILMN_1665065", "ILMN_1748189", "ILMN_2375360", "ILMN_1727078", "ILMN_2407703", "ILMN_1786433", "ILMN_1804357", "ILMN_1651899", "ILMN_2384405", "ILMN_1692785", "ILMN_1679256", "ILMN_1791580", "ILMN_1705922", "ILMN_1767722", "ILMN_1804207", "ILMN_2077886", "ILMN_1705849", "ILMN_1696133", "ILMN_1772798", "ILMN_1802316", "ILMN_2333766", "ILMN_1693119", "ILMN_1790154", "ILMN_1711245", "ILMN_2395055", "ILMN_1662256", "ILMN_1836751", "ILMN_2353642")
probeID=c('ILMN_1755710', 'ILMN_1741133', 'ILMN_2374778', 'ILMN_1764964', 'ILMN_1803392', 'ILMN_1665696', 'ILMN_1681703', 'ILMN_2372543', 'ILMN_1699603', 'ILMN_1693594', 'ILMN_2359698', 'ILMN_1808591', 'ILMN_1702829', 'ILMN_1732926', 'ILMN_1677920', 'ILMN_1729115', 'ILMN_1727840', 'ILMN_1728550', 'ILMN_1766573', 'ILMN_1785731', 'ILMN_1677314', 'ILMN_2104141', 'ILMN_1774602', 'ILMN_2175317', 'ILMN_1779064', 'ILMN_1706505', 'ILMN_1800317', 'ILMN_2371911', 'ILMN_2307861', 'ILMN_1732688', 'ILMN_1766245', 'ILMN_1743911', 'ILMN_1722849', 'ILMN_1715748', 'ILMN_1706643', 'ILMN_1720511', 'ILMN_1783909', 'ILMN_2193980', 'ILMN_1662964', 'ILMN_1685112', 'ILMN_1675239', 'ILMN_2163796', 'ILMN_1693430', 'ILMN_1682264', 'ILMN_1687359', 'ILMN_2381064', 'ILMN_1672536', 'ILMN_1732151', 'ILMN_2323848', 'ILMN_2180371', 'ILMN_1688753', 'ILMN_1660869', 'ILMN_1655261', 'ILMN_1662905', 'ILMN_1769926', 'ILMN_1654151', 'ILMN_1704557', 'ILMN_1795166', 'ILMN_2414399', 'ILMN_1767665', 'ILMN_1693367', 'ILMN_2332250', 'ILMN_2385672', 'ILMN_2223903', 'ILMN_2102330', 'ILMN_1678842', 'ILMN_1679262', 'ILMN_1657509', 'ILMN_1826285', 'ILMN_1745699', 'ILMN_1803213', 'ILMN_1732066', 'ILMN_1671257', 'ILMN_1799289', 'ILMN_1664303', 'ILMN_1669338', 'ILMN_1691290', 'ILMN_1704084', 'ILMN_1706275', 'ILMN_2278152', 'ILMN_2098325', 'ILMN_2128489', 'ILMN_1753345', 'ILMN_1782551', 'ILMN_1662147', 'ILMN_2149766', 'ILMN_2390919', 'ILMN_1704477', 'ILMN_1741356', 'ILMN_1785272', 'ILMN_1793672', 'ILMN_1739496', 'ILMN_1776088', 'ILMN_2311548', 'ILMN_1676563', 'ILMN_2083469', 'ILMN_1701308', 'ILMN_1657864', 'ILMN_1803846', 'ILMN_1776936')
ann=data.frame(Gene=unlist(mget(x = probeID,envir = illuminaHumanv4SYMBOL, ifnotfound=NA)))

discovs <- cbind(discovs, ann$Gene) 
discovs <- na.omit(discovs)

gg=discovs[!duplicated(discovs[c("ann$Gene")]),]

rownames(gg) <- gg$`ann$Gene` 


#discovs[1:(length(discovs)-1)]


#gg=discovs[!duplicated(rownames(discovs)), ]

write.table(gg, file="/Users/andrea/Downloads/ge.txt", sep="\t", quote = FALSE)

filterCommonGenes(input.f="/Users/andrea/Downloads/ge.txt", output.f="discovs.gct", id="GeneSymbol")

#OvarianCancerExpr <- system.file("extdata", "ge.txt", package="estimate")
#filterCommonGenes(input.f=OvarianCancerExpr, output.f="OV_10412genes.gct", id="GeneSymbol")

estimateScore("discovs.gct", "discovs_score.gct", platform="illumina")
plotPurity(scores="discovs_score.gct", samples="MTS.T2224", platform="illumina")

es=c(0.49, 0.79, 0.54, 0.53, 0.69, 0.69, 0.70, 0.67, 0.57, 0.56, 0.72, 0.65, 0.77, 0.69, 0.50, 0.68, 0.67, 0.83, 0.58, 0.67, 0.68, 0.64, 0.60, 0.50, 0.61, 0.65, 0.68, 0.65, 0.46, 0.48, 0.68, 0.53, 0.79, 0.38, 0.68, 0.48, 0.62, 0.87, 0.67, 0.71, 0.59, 0.61, 0.60, 0.57, 0.74, 0.71, 0.69, 0.60, 0.58, 0.59, 0.60, 0.63, 0.62, 0.53, 0.63, 0.82, 0.65, 0.57, 0.56, 0.55, 0.76, 0.65, 0.63, 0.60, 0.44, 0.51, 0.57, 0.60, 0.56, 0.67, 0.44, 0.63, 0.47, 0.62, 0.69, 0.54, 0.48, 0.64, 0.51, 0.80, 0.68, 0.72, 0.70, 0.65, 0.50, 0.60, 0.46, 0.50, 0.71, 0.53, 0.65, 0.48, 0.75, 0.41, 0.75, 0.68, 0.74, 0.62, 0.62, 0.61, 0.61, 0.80, 0.73, 0.46, 0.60, 0.66, 0.66, 0.61, 0.72, 0.51, 0.46, 0.50, 0.64, 0.53, 0.62, 0.58, 0.59, 0.55, 0.60, 0.87, 0.67, 0.56, 0.58, 0.55, 0.58, 0.70, 0.50, 0.59, 0.62, 0.71, 0.68, 0.70, 0.61, 0.46, 0.73, 0.54, 0.61, 0.41, 0.57, 0.68, 0.61, 0.44, 0.60, 0.50, 0.69, 0.79, 0.60, 0.65, 0.52, 0.52, 0.74, 0.69, 0.68, 0.59, 0.47, 0.61, 0.49, 0.67, 0.64, 0.55, 0.60, 0.57, 0.60, 0.51, 0.57, 0.70, 0.70, 0.63, 0.59, 0.75, 0.45, 0.66, 0.59, 0.53, 0.63, 0.56, 0.64, 0.45, 0.52, 0.63, 0.63, 0.58, 0.47, 0.54, 0.63, 0.62, 0.53, 0.49, 0.48, 0.49, 0.50, 0.62, 0.66, 0.53, 0.64, 0.65, 0.49, 0.53, 0.62, 0.60, 0.58, 0.51, 0.60, 0.63, 0.65, 0.53, 0.58, 0.71, 0.66, 0.55, 0.58, 0.51, 0.70, 0.58, 0.70, 0.54, 0.63, 0.56, 0.78, 0.61, 0.62, 0.60, 0.53, 0.57, 0.49, 0.81, 0.58, 0.71, 0.54, 0.58, 0.59, 0.52, 0.58, 0.54, 0.53, 0.43, 0.56, 0.58, 0.63, 0.58, 0.67, 0.45, 0.64, 0.50, 0.58, 0.60, 0.55, 0.47, 0.56, 0.68, 0.61, 0.61, 0.50, 0.55, 0.60, 0.57, 0.61, 0.43, 0.58, 0.63, 0.61, 0.50, 0.54, 0.59, 0.60, 0.60, 0.52, 0.68, 0.75, 0.78, 0.68, 0.56, 0.40, 0.37, 0.66, 0.76, 0.63, 0.52, 0.62, 0.61, 0.32, 0.68, 0.66, 0.38, 0.41, 0.52, 0.52, 0.48, 0.38, 0.42, 0.53, 0.38, 0.75, 0.60, 0.55, 0.45, 0.70, 0.67, 0.52, 0.72, 0.63, 0.55, 0.59, 0.62, 0.47, 0.40, 0.62, 0.38, 0.62, 0.40, 0.52, 0.60, 0.65, 0.57, 0.52, 0.60, 0.49, 0.58, 0.51, 0.74, 0.49, 0.64, 0.77, 0.54, 0.58, 0.61, 0.45, 0.47, 0.52, 0.34, 0.41, 0.43, 0.57, 0.49, 0.63, 0.64, 0.50, 0.37, 0.49, 0.64, 0.48, 0.49, 0.53, 0.48, 0.82, 0.43, 0.48, 0.61, 0.50, 0.40, 0.42, 0.30, 0.67, 0.63, 0.56, 0.65, 0.44, 0.70, 0.58, 0.50, 0.46, 0.38, 0.71, 0.71, 0.39, 0.61, 0.63, 0.64, 0.77, 0.54, 0.41, 0.59, 0.41, 0.55, 0.60, 0.53, 0.58, 0.47, 0.56, 0.61, 0.45, 0.55, 0.40, 0.58, 0.57, 0.40, 0.62, 0.42, 0.49, 0.57, 0.47, 0.48, 0.61, 0.41, 0.54, 0.58, 0.70, 0.37, 0.46, 0.36, 0.55, 0.63, 0.40, 0.49, 0.47, 0.56, 0.41, 0.40, 0.56, 0.43, 0.47, 0.53, 0.60, 0.68, 0.47, 0.48, 0.39, 0.35, 0.60, 0.54, 0.37, 0.31, 0.51, 0.26, 0.42, 0.44, 0.66, 0.52, 0.54, 0.79, 0.43, 0.61, 0.65, 0.46, 0.70, 0.48, 0.65, 0.49, 0.65, 0.58, 0.63, 0.66, 0.61, 0.68, 0.50, 0.56, 0.56, 0.59, 0.62, 0.73, 0.58, 0.62, 0.60, 0.57, 0.53, 0.78, 0.58, 0.55, 0.55, 0.49, 0.62, 0.52, 0.51, 0.64, 0.55, 0.64, 0.68, 0.68, 0.80, 0.74, 0.59, 0.65, 0.55, 0.80, 0.66, 0.85, 0.59, 0.54, 0.49, 0.51, 0.62, 0.46, 0.59, 0.43, 0.66, 0.57, 0.52, 0.75, 0.59, 0.45, 0.66, 0.63, 0.85, 0.54, 0.62, 0.52, 0.57, 0.71, 0.51, 0.62, 0.50, 0.63, 0.59, 0.40, 0.50, 0.64, 0.49, 0.54, 0.56, 0.61, 0.56, 0.64, 0.59, 0.73, 0.58, 0.66, 0.75, 0.59, 0.48, 0.67, 0.64, 0.65, 0.67, 0.74, 0.69, 0.62, 0.76, 0.65, 0.62, 0.68, 0.58, 0.49, 0.51, 0.69, 0.44, 0.67, 0.54, 0.61, 0.80, 0.55, 0.59, 0.75, 0.86, 0.64, 0.83, 0.66, 0.75, 0.67, 0.66, 0.64, 0.58, 0.58, 0.62, 0.67, 0.63, 0.57, 0.73, 0.46, 0.68, 0.62, 0.64, 0.72, 0.59, 0.54, 0.58, 0.61, 0.56, 0.63, 0.57, 0.63, 0.57, 0.70, 0.58, 0.65, 0.52, 0.69, 0.71, 0.67, 0.62, 0.70, 0.81, 0.58, 0.76, 0.65, 0.62, 0.59, 0.69, 0.61, 0.56, 0.40, 0.53, 0.57, 0.56, 0.70, 0.72, 0.62, 0.55, 0.65, 0.67, 0.70, 0.83, 0.67, 0.71, 0.79, 0.75, 0.70, 0.69, 0.68, 0.50, 0.57, 0.59, 0.52, 0.71, 0.38, 0.51, 0.65, 0.50, 0.56, 0.59, 0.66, 0.64, 0.51, 0.50, 0.61, 0.72, 0.71, 0.78, 0.67, 0.53, 0.82, 0.60, 0.62, 0.65, 0.81, 0.68, 0.66, 0.81, 0.60, 0.56, 0.47, 0.63, 0.49, 0.58, 0.41, 0.69, 0.61, 0.55, 0.65, 0.72, 0.57, 0.70, 0.58, 0.57, 0.83, 0.76, 0.55, 0.61, 0.59, 0.55, 0.56, 0.49, 0.67, 0.59, 0.67, 0.59, 0.71, 0.64, 0.62, 0.53, 0.56, 0.63, 0.69, 0.63, 0.49, 0.67, 0.72, 0.60, 0.74, 0.70, 0.63, 0.61, 0.62, 0.72, 0.63, 0.53, 0.70, 0.68, 0.67, 0.78, 0.79, 0.60, 0.69, 0.65, 0.73, 0.67, 0.69, 0.54, 0.61, 0.60, 0.72, 0.65, 0.59, 0.63, 0.63, 0.68, 0.63, 0.78, 0.60, 0.69, 0.83, 0.58, 0.73, 0.66, 0.73, 0.63, 0.77, 0.74, 0.58, 0.74, 0.63, 0.79, 0.55, 0.71, 0.60, 0.71, 0.62, 0.75, 0.59, 0.65, 0.57, 0.60, 0.65, 0.62, 0.57, 0.71, 0.56, 0.53, 0.53, 0.52, 0.72, 0.67, 0.63, 0.64, 0.73, 0.69, 0.63, 0.71, 0.66, 0.78, 0.70, 0.67, 0.77, 0.72, 0.68, 0.66, 0.83, 0.81, 0.61, 0.63, 0.74, 0.62, 0.64, 0.62, 0.75, 0.84, 0.69, 0.67, 0.62, 0.62, 0.65, 0.59, 0.85, 0.60, 0.63, 0.59, 0.64, 0.63, 0.73, 0.67, 0.75, 0.78, 0.60, 0.67, 0.67, 0.62, 0.74, 0.56, 0.66, 0.81, 0.61, 0.71, 0.66, 0.54, 0.67, 0.71, 0.53, 0.57, 0.62, 0.75, 0.65, 0.57, 0.65, 0.66, 0.64, 0.59, 0.54, 0.56, 0.57, 0.63, 0.62, 0.63, 0.66, 0.73, 0.66, 0.68, 0.65, 0.72, 0.60, 0.64, 0.75, 0.70, 0.64, 0.53, 0.70, 0.42, 0.51, 0.49, 0.56, 0.65, 0.68, 0.64, 0.64, 0.56, 0.68, 0.63, 0.57, 0.76, 0.69, 0.69, 0.63, 0.85, 0.70, 0.71, 0.49, 0.45, 0.57, 0.55, 0.74, 0.66, 0.66, 0.60, 0.81, 0.61, 0.46, 0.58, 0.64, 0.75, 0.59, 0.45, 0.63, 0.64, 0.57, 0.64, 0.57, 0.50, 0.47, 0.56, 0.68, 0.52, 0.54, 0.66, 0.63, 0.63, 0.45, 0.50, 0.42, 0.62, 0.71, 0.54, 0.58, 0.59, 0.48, 0.59, 0.61, 0.60, 0.47, 0.63, 0.66, 0.65, 0.69, 0.51, 0.73, 0.51, 0.56, 0.52, 0.42, 0.54, 0.50, 0.58, 0.65, 0.49, 0.51, 0.47, 0.63, 0.47, 0.51, 0.64, 0.60, 0.57, 0.48, 0.52, 0.50, 0.67, 0.62, 0.49, 0.55, 0.77, 0.68, 0.62, 0.62, 0.67, 0.53, 0.56, 0.65, 0.72, 0.65, 0.64, 0.69, 0.51, 0.63, 0.35, 0.60, 0.46, 0.57, 0.50, 0.46, 0.64, 0.57, 0.64, 0.68, 0.54, 0.61, 0.43, 0.67, 0.52, 0.37, 0.67, 0.60, 0.42, 0.57, 0.49, 0.57, 0.64, 0.56, 0.57, 0.54, 0.51, 0.63, 0.67, 0.60)
     
tp 




#first example for simulated two-component data
data(simul2)
inputdata <- as.matrix(gg)
groupid <- c(rep(1, 200), rep(3, 107));
res <- DeMixT(inputdata, groupid)

## Those two examples below will take around hours for finishing the running.
## Be cautious if you want to test those examples.
#second example for simulated three-component data
data(simul3)
inputdata <- as.matrix(simul3)
groupid <- c(rep(1, 5), rep(2,5), rep(3, 5));
res <- DeMixT(inputdata, groupid)

#third example of applying component merging strategy for three-component
#in proportion estimation to a mixed cell line data example (this example
# takes a longer time to be finished.)
data(cell_line_mix)
inputdata <- as.matrix(cell_line_mix)
groupid <- c(rep(1, 6), rep(2,6), rep(3, 8)); 
# input as 2-component
res <- DeMixT(inputdata, groupid, if.filter = TRUE)
